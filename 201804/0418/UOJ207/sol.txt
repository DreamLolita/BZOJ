我们注意到，一条$x$到$y$路径被所有路径经过，当前仅当以$x$为根时，所有路径的端点都恰好有一个在$y$的子树中。
这样，我们对每一个路径随机一个权值，然后每次加入删除路径时，将两个端点的点权异或上这个权值，然后用动态树维护子树权值异或和，
每次询问对应子树内的权值异或和是否是当前所有路径的权值异或和，
权值如果设为$10^9$级别，就基本不可能出错了。