模板练习――KMP

这是一道不错的题目。
首先不考虑数据范围，我们显然是可以dp的。
设f[i][j]表示T的前i个字符的后j个和匹配串的前j个字符的方案数，
前i个号码的后缀构成了前j个不吉利数字，而dp[i][j]向i+1转移相当于在后缀后面新加一个字符，
这个可以联想到AC自动机，然而这个只有一个串所以kmp就足够了。

设a[k][j]为k位后面加一个字母转移到j的方案数，于是：
$$dp[i][j]=\sum_{0<=k<=m-1}dp[i-1][k]*a[k][j]$$
线性齐次递推式可以用快速幂优化，a矩阵对匹配串用KMP预处理即可。