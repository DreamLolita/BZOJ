一个显而易见的做法是：维护所有这$n$个字符组成的长度在 1~50之间的字符串的Hash值，查询时直接统计Hash值出现次数即可。
这样做的时间复杂度是什么呢？
看起来有$m$次合并，是$mk^2$的。
实则不然，当没有2操作时，最终得到的只有$nk$个子串，因此上界严格时复杂度就是$O(nk)$的。
而 2 操作只有 1000 次，每次会产生$k^2$的势能贡献，这一部分也只有$O(ck^2)$。

使用自然溢出Hash (范围是 $2^64=1.8×10^19$) ，再映射到大小为$10233333$的哈希表上即可通过。

时间复杂度$O(nk+ck^2+\sum|S|)$。
LZZ的知乎回答https://www.zhihu.com/question/62597216