神题，看题解，看完还是不会写。对着别人的程序写.gif。
构造SAM即可求出某个字符串在原串中匹配的次数,对$k$阈值

如果$K\leq sqrt n$，即长度不大，暴力枚举区间即可，复杂度$O(K^2 q)$

如果$k\geq sqrt n$，那么每一个询问区间都是一个串前缀的后缀，这个可以倍增跳fail来做，复杂度为$O(q(K+mlogK))$