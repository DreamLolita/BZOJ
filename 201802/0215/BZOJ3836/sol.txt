对于每个点$x$，设$S$为三进制状态，$S$第$i$位表示根到$x$路径上深度为$i$的点的状态：
0：选了；1：没选，且没满足 ；2：没选，且已满足
设$f[i][j]$表示考虑根到$x$路径上深度为$i$的点时这些点的状态为$j$时的最小费用，然后按DFS序进行DP即可。