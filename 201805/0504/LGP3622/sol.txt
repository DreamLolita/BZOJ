观察到每个小朋友能观察到的动物很少，于是我们可以考虑状压。
令f[i][sta] (0<=sta<2^5)来表示i和i逆时针方向这5个围栏的选取状态为二进制数sta时，从以第一个围栏为最后的围栏的小朋友开始到以第i个围栏为最后的围栏的小朋友中，最多有多少个高兴。
那么f[i][j]=max(f[i-1][(j>>1)&31],f[i-1][(j>>1)+16])+num[i][j]
其中num[i][j]表示以第i个围栏为最后一个围栏的小朋友中，在i-4~i这5个围栏选取状态为j的情况下，有多少人高兴。
num[][]的预处理可以用前向星暴力处理。注意处理环。
最后递推的时候，也要注意环带来的影响，暴力枚举初始状态，把其余的赋为-inf，递推着走，最后选取与初始位置匹配的状态即可。

实际上这题可以用网络流来做，不过复杂度会爆炸