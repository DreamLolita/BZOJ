首先对于S和T在一侧的可以直接处理。
考虑k=1的情况，我们将所有点投影到数轴上，要求的实际上就是一个到所有点距离和最短的点，这个显然是最中间两个点的位置。
那么推广到k=2，观察到一组(S,T)的贡献位置和(S+T)/2有关，那么我们按照这个数排序。
接着我们可以枚举一个分界线，左边的建一座桥，右边的建一座，这个可以用Splay来维护中间数位置，主要每次移动分界线都要移动两个点。