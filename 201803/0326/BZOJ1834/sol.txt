第一问是告诉你建图的最大流。
对于第二问，可以从第一问的残量网络上继续建图，对残量网络上的每一条边建一条容量是INF费用是w的边，然后建一个S，从S向1建一条容量为k，费用为0的边，跑最小费用最大流即可。