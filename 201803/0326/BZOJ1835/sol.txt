设$f[i][j]$表示第$i$个村建第$j$个基站的最小花费，则有转移式：
$f[i][j]=min{ f[k][j-1]+cost(k,i) } + c[i] ,j-1<=k<=i-1$
$cost(k,i)=\sum w[x] ,k+1<=x<=i-1$, 且$x$未被覆盖
$f[][]$需要求一个区间最小值，我们尝试用线段树维护每一层的这个值。
枚举$j$，考虑每一层$i$。
我们设$st[i],ed[i]$分别表示在$i$左右距离$i$最远的$st[i],ed[i]$建基站依旧可以覆盖到$i$，假设我们已经求完了$f[i][j]$要求$f[i+1][j]$，考虑那些恰可以被$i$覆盖到而不能被$i+1$覆盖到的，即满足$ed[x]=i$的点，将$[1..st[x]-1]$区间内的线段树值都加$w[x]$，意为前一个基站$k$位于$[1..st[x]-1]$那么点$x$因不会被覆盖到需要做出赔偿。
求$f[i]$的时候查询区间$[1..i-1]$内线段树值的最小即可,其中$st[i],ed[i]$可以用二分求。
总的时间复杂度为$O(nklogn)$