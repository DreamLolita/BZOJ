对于当前的图，找到一条边能够把图分成左右两半。
对于询问$(x,y)$，若$x$在这条边的左边，$y$在这条边的右边，那么这个询问的最短路程一定经过这条边的两个端点之一，用spfa什么的求出这条边两个端点到当前图的每个点的最短路径，然后就可以求出这样跨过这条的询问的答案。然后递归处理左右两半。

另一种点分的方法参考Claris：
首先拓扑，每次取出度数为2的点，这样可以把所有三角形都找到。那么建出对偶图，会发现是一棵树。
对这棵树进行点分治，每次取出重心，DFS求出所有在里面的点，然后从重心3个点分别做一次BFS。
对于每个询问，如果不经过重心这个区域，那么递归求解，否则用BFS的结果回答即可。