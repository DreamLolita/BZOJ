可以发现约束其实就是一些对应位置相等的限制，我们使用并查集，采用最暴力方法合并，时间复杂度为$O(nm)$。如果最后一共剩下$cnt$个集合，如果某个集合不包含第一位，那么它肯定有10种取值，否则只有9种。那么答案就是$9*10^{cnt-1}$（当然$n=1$时答案为10）。 
这里速度慢主要因为很多限制是重复的，所以我们要考虑减少重复计算本质上相同的限制。
用ST表实现这一过程，$f[i][j]$表示$[i,i+2^j-1]$这一区间的情况。
对于每一个限制，可以拆成两个大的限制，然后逐层向下传递，直到某一层的两个区间处于同一集合，也就说明这次限制之前已经又过了，就不需要再向下处理。
每一层最坏合并n次，一共$logn$层，复杂度是$O(nlogn)$。