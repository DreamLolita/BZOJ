给一个长度为$n$的序列,第$i$个数是$a_i$，选取一个连续子序列$\{a_x,a_{x+1},...,a_{x+k-1}\}$使得$\sum_{i=1}^k i\cdot a_{x+i-1}$最大。

记$pre[i]$为$val[i]$的前缀和。$pre2[i]$为每一个数值乘以所在位置的值的前缀和。
那么$sum(i,j)=pre2[j]-pre2[i-1]-(i-1)*(pre[j]-pre[i-1])$。所求的即$sum(i,j)$的最大值。

然后这个显然是一个斜率优化的形式，
接下来对于一个点$j$，我们往前找$i$要满足$-(i-1)*pre[j]+(i-1)*pre[i-1]-pre2[i-1]$这个值最大。就是维护(i,i*pre[i]-pre2[i])的下凸壳。凸壳上二分就行了。