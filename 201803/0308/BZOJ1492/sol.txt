$n^2$dp很显然,设$x[i]$,$y[i]$分别表示第$i$天最多买进的两种金券的数量，那么$f[i]=max(f[i-1],x[j]*a[i]+y[j]*b[i])$
考虑斜率优化，$f[i]=max(x[j]*a[i]+y[j]*b[i]),y[j]=(\frac {-a[i]} {b[i]})*x[j]+\frac {f[i]} {b[i]}$，$\frac {-a[i]} {b[i]}$看作斜率，表示成了关于平面$x,y$上的斜率关系。$b_i$不变，要让$f_i$最大，就要让截距最大。很容易发现，满足的点都在$(x,y)$的上凸壳上，所以我们维护这个凸壳。
由于$x_i$不一定是连续的，不能直接单调队列做，于是我们可以采用CDQ分治